---
# Generated from Terraform output - 2026-02-11
# Storage Benchmark Infrastructure (iSCSI Architecture)
#
# iSCSI Target: 172.16.100.2:3260
#   LUN 1: vm-bench (50G) — direct iSCSI from Linux VMs
#   LUN 2: esxi-datastore (100G) — VMFS6 on ESXi
#
# SSH via bastion: bastion@163.172.158.12:61000

all:
  vars:
    ansible_python_interpreter: /usr/bin/python3
    ansible_ssh_common_args: '-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ProxyJump=bastion@163.172.158.12:61000'

    # Storage Proxy
    proxy_private_ip: "172.16.100.2"
    filestorage_mount: "/mnt/filestorage"
    filestorage_id: "fr-par/c875f6f4-de3b-4488-9187-ee4a685948ee"
    filestorage_size_gb: 500

    # iSCSI Configuration
    iscsi_target_iqn: "iqn.2026-02.fr.scaleway:filestorage.bench"
    iscsi_portal: "172.16.100.2:3260"
    iscsi_auth_user: "bench"
    iscsi_auth_pass: "benchpass123"
    iscsi_lun_vm_size_gb: 50
    iscsi_lun_esxi_size_gb: 100

    # Bastion info
    bastion_host: "163.172.158.12"
    bastion_port: 61000
    pn_name: "storage-bench-bench-pn"

    # Benchmark Configuration
    benchmark_dir: "/opt/benchmarks"
    results_dir: "/opt/benchmarks/results"
    fio_runtime: 60
    fio_size: "10G"

  children:
    # =========================================================================
    # iSCSI Proxy (POP2 Instance with File Storage)
    # =========================================================================
    nfs_proxy:
      hosts:
        storage-bench-nfs-proxy:
          ansible_host: storage-bench-nfs-proxy.storage-bench-bench-pn.internal
          ansible_user: root
          private_ip: 172.16.100.2
          role: iscsi-proxy

    # =========================================================================
    # ESXi Hosts (Elastic Metal)
    # =========================================================================
    esxi_hosts:
      hosts:
        storage-bench-esxi-par2:
          ansible_host: storage-bench-esxi-par2.storage-bench-bench-pn.internal
          ansible_user: root
          private_ip: 172.16.100.20
          zone: fr-par-2
          role: esxi

    # =========================================================================
    # Benchmark VMs
    # =========================================================================
    benchmark_vms:
      vars:
        ansible_ssh_extra_args: '-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null'
        iscsi_mount_path: "/mnt/iscsi-bench"
      hosts:
        esxi-bench-vm-direct:
          ansible_host: 172.16.100.22
          ansible_user: fabien
          ansible_password: fabien
          ansible_become: true
          ansible_become_password: fabien
          bench_scenario: "esxi-vm-iscsi-direct"
          bench_target_path: "/mnt/iscsi-bench/bench"
          iscsi_lun_id: 1
